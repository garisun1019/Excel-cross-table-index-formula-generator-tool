<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excelè·¨è¡¨æ ¼ç´¢å¼•å…¬å¼ç”Ÿæˆå™¨</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 900px;
            padding: 30px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .description {
            color: #7f8c8d;
            line-height: 1.6;
            max-width: 700px;
            margin: 0 auto;
        }
        
        .form-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .form-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        
        .form-section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 20px;
            display: flex;
            align-items: center;
        }
        
        .form-section h2 i {
            margin-right: 10px;
            color: #3498db;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #34495e;
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
            width: 100%;
            font-weight: 600;
            margin-top: 10px;
        }
        
        .btn:hover {
            background: #2980b9;
        }
        
        .result-container {
            margin-top: 30px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            display: none;
        }
        
        .result-container h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 20px;
        }
        
        .formula-box {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            margin-bottom: 20px;
            overflow-x: auto;
            white-space: nowrap;
        }
        
        .instructions {
            background: #e8f4fc;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #3498db;
        }
        
        .instructions h3 {
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .instructions ol {
            margin-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        
        .examples {
            margin-top: 20px;
            font-size: 14px;
            color: #7f8c8d;
        }
        
        @media (max-width: 768px) {
            .form-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Excelè·¨è¡¨æ ¼ç´¢å¼•å…¬å¼ç”Ÿæˆå™¨</h1>
            <p class="description">è¾“å…¥å‚è€ƒè¡¨ä¿¡æ¯ï¼Œè‡ªåŠ¨ç”ŸæˆINDEX-MATCHå…¬å¼ï¼Œç”¨äºè·¨è¡¨æ ¼ç´¢å¼•æ•°æ®ã€‚</p>
        </header>
        
        <div class="form-container">
            <div class="form-section">
                <h2><i>ğŸ“Š</i> å‚è€ƒè¡¨è®¾ç½®</h2>
                <div class="form-group">
                    <label for="refSheetName">å‚è€ƒè¡¨åç§°</label>
                    <input type="text" id="refSheetName" placeholder="ä¾‹å¦‚ï¼šæ ‘ç§åˆ†ç±»åŸºç¡€è¡¨" value="æ ‘ç§åˆ†ç±»åŸºç¡€è¡¨">
                </div>
                <div class="form-group">
                    <label for="refMatchCol">å‚è€ƒè¡¨ä¸­ç”¨äºåŒ¹é…çš„åˆ—</label>
                    <input type="text" id="refMatchCol" placeholder="ä¾‹å¦‚ï¼šF" value="F">
                </div>
                <div class="form-group">
                    <label for="targetCols">è¦ç´¢å¼•çš„åˆ—ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰</label>
                    <input type="text" id="targetCols" placeholder="ä¾‹å¦‚ï¼šA,B,M" value="A,B,M">
                </div>
            </div>
            
            <div class="form-section">
                <h2><i>ğŸ“ˆ</i> å½“å‰è¡¨è®¾ç½®</h2>
                <div class="form-group">
                    <label for="currentMatchCol">å½“å‰è¡¨ä¸­ç”¨äºåŒ¹é…çš„åˆ—</label>
                    <input type="text" id="currentMatchCol" placeholder="ä¾‹å¦‚ï¼šF" value="F">
                </div>
                <div class="form-group">
                    <label for="resultCols">ç»“æœåˆ—ï¼ˆç”¨é€—å·åˆ†éš”ï¼Œä¸ç›®æ ‡åˆ—å¯¹åº”ï¼‰</label>
                    <input type="text" id="resultCols" placeholder="ä¾‹å¦‚ï¼šC,D,E" value="C,D,E">
                </div>
                <div class="form-group">
                    <label for="startRow">æ•°æ®èµ·å§‹è¡Œå·</label>
                    <input type="number" id="startRow" min="2" value="2">
                </div>
            </div>
        </div>
        
        <button class="btn" id="generateBtn">ç”Ÿæˆå…¬å¼</button>
        
        <div class="result-container" id="resultContainer">
            <h2>ç”Ÿæˆçš„å…¬å¼</h2>
            <div class="formula-box" id="formulaOutput"></div>
            
            <div class="instructions">
                <h3>ä½¿ç”¨è¯´æ˜</h3>
                <ol>
                    <li>å°†ç”Ÿæˆçš„å…¬å¼å¤åˆ¶åˆ°Excelä¸­å¯¹åº”çš„å•å…ƒæ ¼</li>
                    <li>å°†å…¬å¼ä¸­çš„è¡Œå·ï¼ˆå¦‚2ï¼‰æ›¿æ¢ä¸ºå®é™…çš„è¡Œå·</li>
                    <li>æ‹–åŠ¨å¡«å……æŸ„å°†å…¬å¼åº”ç”¨åˆ°æ‰€æœ‰ç›¸å…³å•å…ƒæ ¼</li>
                    <li>å¦‚æœå‡ºç°#N/Aé”™è¯¯ï¼Œæ£€æŸ¥ä¸¤ä¸ªè¡¨ä¸­çš„åŒ¹é…å€¼æ˜¯å¦å®Œå…¨ä¸€è‡´</li>
                </ol>
            </div>
            
            <div class="examples">
                <p><strong>ç¤ºä¾‹ï¼š</strong> å¦‚æœå‚è€ƒè¡¨åä¸º"æ ‘ç§åˆ†ç±»åŸºç¡€è¡¨"ï¼Œå‚è€ƒåŒ¹é…åˆ—ä¸ºFåˆ—ï¼Œè¦ç´¢å¼•Aã€Bã€Måˆ—ï¼Œå½“å‰è¡¨åŒ¹é…åˆ—ä¸ºFåˆ—ï¼Œç»“æœåˆ—ä¸ºCã€Dã€Eåˆ—ï¼Œèµ·å§‹è¡Œå·ä¸º2ï¼Œåˆ™ç”Ÿæˆçš„å…¬å¼ä¸ºï¼š</p>
                <p>=INDEX(æ ‘ç§åˆ†ç±»åŸºç¡€è¡¨!A:A, MATCH(F2, æ ‘ç§åˆ†ç±»åŸºç¡€è¡¨!F:F, 0))</p>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('generateBtn').addEventListener('click', function() {
            // è·å–è¾“å…¥å€¼
            const refSheetName = document.getElementById('refSheetName').value.trim();
            const refMatchCol = document.getElementById('refMatchCol').value.trim().toUpperCase();
            const targetCols = document.getElementById('targetCols').value.trim().toUpperCase().split(',').map(col => col.trim());
            const currentMatchCol = document.getElementById('currentMatchCol').value.trim().toUpperCase();
            const resultCols = document.getElementById('resultCols').value.trim().toUpperCase().split(',').map(col => col.trim());
            const startRow = document.getElementById('startRow').value;
            
            // éªŒè¯è¾“å…¥
            if (!refSheetName || !refMatchCol || targetCols.length === 0 || 
                !currentMatchCol || resultCols.length === 0 || !startRow) {
                alert('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µï¼');
                return;
            }
            
            if (targetCols.length !== resultCols.length) {
                alert('ç›®æ ‡åˆ—å’Œç»“æœåˆ—çš„æ•°é‡å¿…é¡»ç›¸åŒï¼');
                return;
            }
            
            // ç”Ÿæˆå…¬å¼
            let formulas = '';
            for (let i = 0; i < targetCols.length; i++) {
                const formula = `=INDEX(${refSheetName}!${targetCols[i]}:${targetCols[i]}, MATCH(${currentMatchCol}${startRow}, ${refSheetName}!${refMatchCol}:${refMatchCol}, 0))`;
                formulas += `åœ¨${resultCols[i]}${startRow}å•å…ƒæ ¼è¾“å…¥ï¼š\n${formula}\n\n`;
            }
            
            // æ˜¾ç¤ºç»“æœ
            document.getElementById('formulaOutput').textContent = formulas;
            document.getElementById('resultContainer').style.display = 'block';
            
            // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
            document.getElementById('resultContainer').scrollIntoView({ behavior: 'smooth' });
        });
    </script>
</body>
</html>
